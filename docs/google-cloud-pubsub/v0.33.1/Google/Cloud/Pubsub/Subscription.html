---
layout: yard_main
title: "Class: Google::Cloud::Pubsub::Subscription - Google"
css: 
  - /docs/css/style.css
  - /docs/css/common.css
  - /css/yard-main.css
js: 
  - /docs/js/app.js
  - /js/yard-main.js
---
<script type="text/javascript" charset="utf-8">
  pathId = "Google::Cloud::Pubsub::Subscription";
  relpath = '../../../';
</script>


<div class="nav_wrap">
  <iframe id="nav" src="../../../class_list.html?1"></iframe>
  <div id="resizer"></div>
</div>

<div id="main" tabindex="-1">
  <div id="header">
    <div id="menu">
  
    <a href="../../../_index.html">Index (S)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span>
     &raquo; 
    <span class="title">Subscription</span>
  
</div>

    <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
    <div class="clear"></div>
  </div>

  <div id="content"><h1>Class: Google::Cloud::Pubsub::Subscription
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Google::Cloud::Pubsub::Subscription</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/google/cloud/pubsub/subscription.rb<span class="defines">,<br />
  lib/google/cloud/pubsub/subscription/list.rb</span>
</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <h1>Subscription</h1>

<p>A named resource representing the stream of messages from a single,
specific <span class='object_link'><a href="Topic.html" title="Google::Cloud::Pubsub::Topic (class)">Topic</a></span>, to be delivered to the subscribing application.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_subscriber'>subscriber</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_listen'>listen</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_received_message'>received_message</span><span class='op'>|</span>
  <span class='comment'># process message
</span>  <span class='id identifier rubyid_received_message'>received_message</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge!'>acknowledge!</span>
<span class='kw'>end</span>

<span class='comment'># Start background threads that will call the block passed to listen.
</span><span class='id identifier rubyid_subscriber'>subscriber</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span>

<span class='comment'># Shut down the subscriber when ready to stop receiving messages.
</span><span class='id identifier rubyid_subscriber'>subscriber</span><span class='period'>.</span><span class='id identifier rubyid_stop'>stop</span><span class='period'>.</span><span class='id identifier rubyid_wait!'>wait!</span></code></pre>
    
  </div>


</div><h2>Defined Under Namespace</h2>
<p class="children">
  
    
  
    
      <strong class="classes">Classes:</strong> <span class='object_link'><a href="Subscription/List.html" title="Google::Cloud::Pubsub::Subscription::List (class)">List</a></span>
    
  
</p>







  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#acknowledge-instance_method" title="#acknowledge (instance method)">#<strong>acknowledge</strong>(*messages)  &#x21d2; Object </a>
    

    
      (also: #ack)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Acknowledges receipt of a message.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#create_snapshot-instance_method" title="#create_snapshot (instance method)">#<strong>create_snapshot</strong>(snapshot_name = nil, labels: nil)  &#x21d2; Google::Cloud::Pubsub::Snapshot </a>
    

    
      (also: #new_snapshot)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Creates a new <span class='object_link'><a href="Snapshot.html" title="Google::Cloud::Pubsub::Snapshot (class)">Snapshot</a></span> from the subscription.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deadline-instance_method" title="#deadline (instance method)">#<strong>deadline</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>This value is the maximum number of seconds after a subscriber receives a message before the subscriber should acknowledge the message.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#deadline=-instance_method" title="#deadline= (instance method)">#<strong>deadline=</strong>(new_deadline)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delay-instance_method" title="#delay (instance method)">#<strong>delay</strong>(new_deadline, *messages)  &#x21d2; Object </a>
    

    
      (also: #modify_ack_deadline)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Modifies the acknowledge deadline for messages.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#delete-instance_method" title="#delete (instance method)">#<strong>delete</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Deletes an existing subscription.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#endpoint-instance_method" title="#endpoint (instance method)">#<strong>endpoint</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Returns the URL locating the endpoint to which messages should be pushed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#endpoint=-instance_method" title="#endpoint= (instance method)">#<strong>endpoint=</strong>(new_endpoint)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Sets the URL locating the endpoint to which messages should be pushed.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exists%3F-instance_method" title="#exists? (instance method)">#<strong>exists?</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Determines whether the subscription exists in the Pub/Sub service.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#labels-instance_method" title="#labels (instance method)">#<strong>labels</strong>  &#x21d2; Hash </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>A hash of user-provided labels associated with this subscription.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#labels=-instance_method" title="#labels= (instance method)">#<strong>labels=</strong>(new_labels)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Sets the hash of user-provided labels associated with this subscription.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#listen-instance_method" title="#listen (instance method)">#<strong>listen</strong>(deadline: nil, streams: nil, inventory: nil, threads: {}) {|received_message| ... } &#x21d2; Subscriber </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Create a <span class='object_link'><a href="Subscriber.html" title="Google::Cloud::Pubsub::Subscriber (class)">Subscriber</a></span> object that receives  and processes messages using the code provided in the callback.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#name-instance_method" title="#name (instance method)">#<strong>name</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The name of the subscription.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#policy-instance_method" title="#policy (instance method)">#<strong>policy</strong> {|policy| ... } &#x21d2; Policy </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Gets the <a href="https://cloud.google.com/iam/">Cloud IAM</a> access control policy for this subscription.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pull-instance_method" title="#pull (instance method)">#<strong>pull</strong>(immediate: true, max: 100)  &#x21d2; Array&lt;Google::Cloud::Pubsub::ReceivedMessage&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Pulls messages from the server.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#retain_acked-instance_method" title="#retain_acked (instance method)">#<strong>retain_acked</strong>  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Indicates whether to retain acknowledged messages.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#retain_acked=-instance_method" title="#retain_acked= (instance method)">#<strong>retain_acked=</strong>(new_retain_acked)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#retention-instance_method" title="#retention (instance method)">#<strong>retention</strong>  &#x21d2; Numeric </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>How long to retain unacknowledged messages in the subscription&#39;s backlog, from the moment a message is published.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#retention=-instance_method" title="#retention= (instance method)">#<strong>retention=</strong>(new_retention)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#seek-instance_method" title="#seek (instance method)">#<strong>seek</strong>(snapshot)  &#x21d2; Boolean </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Resets the subscription&#39;s backlog to a given <span class='object_link'><a href="Snapshot.html" title="Google::Cloud::Pubsub::Snapshot (class)">Snapshot</a></span> or to a point in time, whichever is provided in the request.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#test_permissions-instance_method" title="#test_permissions (instance method)">#<strong>test_permissions</strong>(*permissions)  &#x21d2; Array&lt;String&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Tests the specified permissions against the <a href="https://cloud.google.com/iam/">Cloud IAM</a> access control policy.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#topic-instance_method" title="#topic (instance method)">#<strong>topic</strong>  &#x21d2; Topic </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The <span class='object_link'><a href="Topic.html" title="Google::Cloud::Pubsub::Topic (class)">Topic</a></span> from which this subscription receives messages.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_policy-instance_method" title="#update_policy (instance method)">#<strong>update_policy</strong>(new_policy)  &#x21d2; Policy </a>
    

    
      (also: #policy=)
    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Updates the <a href="https://cloud.google.com/iam/">Cloud IAM</a> access control policy for this subscription.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#wait_for_messages-instance_method" title="#wait_for_messages (instance method)">#<strong>wait_for_messages</strong>(max: 100)  &#x21d2; Array&lt;Google::Cloud::Pubsub::ReceivedMessage&gt; </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Pulls from the server while waiting for messages to become available.</p>
</div></span>
  
</li>

      
    </ul>
  



  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="acknowledge-instance_method">
  
    #<strong>acknowledge</strong>(*messages)  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='ack-instance_method'>ack</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Acknowledges receipt of a message. After an ack,
the Pub/Sub system can remove the message from the subscription.
Acknowledging a message whose ack deadline has expired may succeed,
although the message may have been sent again.
Acknowledging a message more than once will not result in an error.
This is only used for messages received via pull.</p>

<p>See also <span class='object_link'><a href="ReceivedMessage.html#acknowledge!-instance_method" title="Google::Cloud::Pubsub::ReceivedMessage#acknowledge! (method)">ReceivedMessage#acknowledge!</a></span>.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_received_messages'>received_messages</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span>
<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge'>acknowledge</span> <span class='id identifier rubyid_received_messages'>received_messages</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>messages</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ReceivedMessage.html" title="Google::Cloud::Pubsub::ReceivedMessage (class)">ReceivedMessage</a></span></tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>One or more
<span class='object_link'><a href="ReceivedMessage.html" title="Google::Cloud::Pubsub::ReceivedMessage (class)">ReceivedMessage</a></span> objects or ack_id values.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


461
462
463
464
465
466
467</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 461</span>

<span class='kw'>def</span> <span class='id identifier rubyid_acknowledge'>acknowledge</span> <span class='op'>*</span><span class='id identifier rubyid_messages'>messages</span>
  <span class='id identifier rubyid_ack_ids'>ack_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_coerce_ack_ids'>coerce_ack_ids</span> <span class='id identifier rubyid_messages'>messages</span>
  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_ack_ids'>ack_ids</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge'>acknowledge</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_ack_ids'>ack_ids</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="create_snapshot-instance_method">
  
    #<strong>create_snapshot</strong>(snapshot_name = nil, labels: nil)  &#x21d2; <tt><span class='object_link'><a href="Snapshot.html" title="Google::Cloud::Pubsub::Snapshot (class)">Google::Cloud::Pubsub::Snapshot</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='new_snapshot-instance_method'>new_snapshot</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Creates a new <span class='object_link'><a href="Snapshot.html" title="Google::Cloud::Pubsub::Snapshot (class)">Google::Cloud::Pubsub::Snapshot</a></span> from the subscription. The created snapshot
is guaranteed to retain:</p>

<ul>
<li>The existing backlog on the subscription. More precisely, this is
defined as the messages in the subscription&#39;s backlog that are
unacknowledged upon the successful completion of the
<code>create_snapshot</code> operation; as well as:</li>
<li>Any messages published to the subscription&#39;s topic following the
successful completion of the <code>create_snapshot</code> operation.</li>
</ul>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>
<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-sub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_snapshot'>snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_create_snapshot'>create_snapshot</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-snapshot</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_snapshot'>snapshot</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'>#=&gt; &quot;projects/my-project/snapshots/my-snapshot&quot;</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Without providing a name:</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>
<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-sub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_snapshot'>snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_create_snapshot'>create_snapshot</span>
<span class='id identifier rubyid_snapshot'>snapshot</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'>#=&gt; &quot;projects/my-project/snapshots/gcr-analysis-...&quot;</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>snapshot_name</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>nil</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'><p>Name of the new snapshot. If the
name is not provided, the server will assign a random name
for this snapshot on the same project as the subscription. The
format is <code>projects/{project}/snapshots/{snap}</code>. The name must start
with a letter, and contain only letters ([A-Za-z]), numbers
([0-9], dashes (-), underscores (_), periods (.), tildes (~), plus
(+) or percent signs (%). It must be between 3 and 255 characters in
length, and it must not start with &quot;goog&quot;. Optional.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>labels</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A hash of user-provided labels associated with
the snapshot. You can use these to organize and group your
snapshots. Label keys and values can be no longer than 63
characters, can only contain lowercase letters, numeric characters,
underscores and dashes. International characters are allowed. Label
values are optional. Label keys must start with a letter and each
label in the list must have a different key. See <a href="https://cloud.google.com/pubsub/docs/labels">Creating and
Managing Labels</a>.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Snapshot.html" title="Google::Cloud::Pubsub::Snapshot (class)">Google::Cloud::Pubsub::Snapshot</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


552
553
554
555
556</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 552</span>

<span class='kw'>def</span> <span class='id identifier rubyid_create_snapshot'>create_snapshot</span> <span class='id identifier rubyid_snapshot_name'>snapshot_name</span> <span class='op'>=</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>labels:</span> <span class='kw'>nil</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_grpc'>grpc</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_create_snapshot'>create_snapshot</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_snapshot_name'>snapshot_name</span><span class='comma'>,</span> <span class='label'>labels:</span> <span class='id identifier rubyid_labels'>labels</span>
  <span class='const'><span class='object_link'><a href="Snapshot.html" title="Google::Cloud::Pubsub::Snapshot (class)">Snapshot</a></span></span><span class='period'>.</span><span class='id identifier rubyid_from_grpc'>from_grpc</span> <span class='id identifier rubyid_grpc'>grpc</span><span class='comma'>,</span> <span class='id identifier rubyid_service'>service</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deadline-instance_method">
  
    #<strong>deadline</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>This value is the maximum number of seconds after a subscriber
receives a message before the subscriber should acknowledge the
message.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


95
96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 95</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deadline'>deadline</span>
  <span class='id identifier rubyid_ensure_grpc!'>ensure_grpc!</span>
  <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_ack_deadline_seconds'>ack_deadline_seconds</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="deadline=-instance_method">
  
    #<strong>deadline=</strong>(new_deadline)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


100
101
102
103
104
105
106</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 100</span>

<span class='kw'>def</span> <span class='id identifier rubyid_deadline='>deadline=</span> <span class='id identifier rubyid_new_deadline'>new_deadline</span>
  <span class='id identifier rubyid_update_grpc'>update_grpc</span> <span class='op'>=</span> <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_update_grpc'>update_grpc</span><span class='period'>.</span><span class='id identifier rubyid_ack_deadline_seconds'>ack_deadline_seconds</span> <span class='op'>=</span> <span class='id identifier rubyid_new_deadline'>new_deadline</span>
  <span class='ivar'>@grpc</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_update_subscription'>update_subscription</span> <span class='id identifier rubyid_update_grpc'>update_grpc</span><span class='comma'>,</span>
                                      <span class='symbol'>:ack_deadline_seconds</span>
  <span class='ivar'>@lazy</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delay-instance_method">
  
    #<strong>delay</strong>(new_deadline, *messages)  &#x21d2; <tt>Object</tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='modify_ack_deadline-instance_method'>modify_ack_deadline</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Modifies the acknowledge deadline for messages.</p>

<p>This indicates that more time is needed to process the messages, or to
make the messages available for redelivery if the processing was
interrupted.</p>

<p>See also <span class='object_link'><a href="ReceivedMessage.html#delay!-instance_method" title="Google::Cloud::Pubsub::ReceivedMessage#delay! (method)">ReceivedMessage#delay!</a></span>.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_received_messages'>received_messages</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span>
<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_delay'>delay</span> <span class='int'>120</span><span class='comma'>,</span> <span class='id identifier rubyid_received_messages'>received_messages</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>new_deadline</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The new ack deadline in seconds from the
time this request is sent to the Pub/Sub system. Must be &gt;= 0. For
example, if the value is <code>10</code>, the new ack deadline will expire 10
seconds after the call is made. Specifying <code>0</code> may immediately make
the message available for another pull request.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>messages</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ReceivedMessage.html" title="Google::Cloud::Pubsub::ReceivedMessage (class)">ReceivedMessage</a></span></tt>, <tt>String</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>One or more
<span class='object_link'><a href="ReceivedMessage.html" title="Google::Cloud::Pubsub::ReceivedMessage (class)">ReceivedMessage</a></span> objects or ack_id values.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


496
497
498
499
500
501</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 496</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delay'>delay</span> <span class='id identifier rubyid_new_deadline'>new_deadline</span><span class='comma'>,</span> <span class='op'>*</span><span class='id identifier rubyid_messages'>messages</span>
  <span class='id identifier rubyid_ack_ids'>ack_ids</span> <span class='op'>=</span> <span class='id identifier rubyid_coerce_ack_ids'>coerce_ack_ids</span> <span class='id identifier rubyid_messages'>messages</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_modify_ack_deadline'>modify_ack_deadline</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_ack_ids'>ack_ids</span><span class='comma'>,</span> <span class='id identifier rubyid_new_deadline'>new_deadline</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="delete-instance_method">
  
    #<strong>delete</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Deletes an existing subscription.
All pending messages in the subscription are immediately dropped.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Returns <code>true</code> if the subscription was deleted.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


266
267
268
269
270</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 266</span>

<span class='kw'>def</span> <span class='id identifier rubyid_delete'>delete</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_delete_subscription'>delete_subscription</span> <span class='id identifier rubyid_name'>name</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="endpoint-instance_method">
  
    #<strong>endpoint</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Returns the URL locating the endpoint to which messages should be
pushed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


158
159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 158</span>

<span class='kw'>def</span> <span class='id identifier rubyid_endpoint'>endpoint</span>
  <span class='id identifier rubyid_ensure_grpc!'>ensure_grpc!</span>
  <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_push_config'>push_config</span><span class='period'>.</span><span class='id identifier rubyid_push_endpoint'>push_endpoint</span> <span class='kw'>if</span> <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_push_config'>push_config</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="endpoint=-instance_method">
  
    #<strong>endpoint=</strong>(new_endpoint)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Sets the URL locating the endpoint to which messages should be pushed.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


165
166
167
168
169
170
171
172
173
174
175</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 165</span>

<span class='kw'>def</span> <span class='id identifier rubyid_endpoint='>endpoint=</span> <span class='id identifier rubyid_new_endpoint'>new_endpoint</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_modify_push_config'>modify_push_config</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_endpoint'>new_endpoint</span><span class='comma'>,</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='ivar'>@grpc</span>

  <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_push_config'>push_config</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Pubsub.html" title="Google::Pubsub (module)">Pubsub</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Pubsub/V1.html" title="Google::Pubsub::V1 (module)">V1</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Pubsub/V1/PushConfig.html" title="Google::Pubsub::V1::PushConfig (class)">PushConfig</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span>
    <span class='label'>push_endpoint:</span> <span class='id identifier rubyid_new_endpoint'>new_endpoint</span><span class='comma'>,</span>
    <span class='label'>attributes:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
  <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="exists?-instance_method">
  
    #<strong>exists?</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Determines whether the subscription exists in the Pub/Sub service.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_exists?'>exists?</span> <span class='comment'>#=&gt; true</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


224
225
226
227
228
229
230
231
232
233</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 224</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exists?'>exists?</span>
  <span class='comment'># Always true if the object is not set as lazy
</span>  <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>unless</span> <span class='id identifier rubyid_lazy?'>lazy?</span>
  <span class='comment'># If we have a value, return it
</span>  <span class='kw'>return</span> <span class='ivar'>@exists</span> <span class='kw'>unless</span> <span class='ivar'>@exists</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_ensure_grpc!'>ensure_grpc!</span>
  <span class='ivar'>@exists</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'>NotFoundError</span>
  <span class='ivar'>@exists</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="labels-instance_method">
  
    #<strong>labels</strong>  &#x21d2; <tt>Hash</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>A hash of user-provided labels associated with this subscription.
Labels can be used to organize and group subscriptions.See <a href="https://cloud.google.com/pubsub/docs/labels">Creating
and Managing Labels</a>.</p>

<p>The returned hash is frozen and changes are not allowed. Use
<span class='object_link'><a href="#labels=-instance_method" title="Google::Cloud::Pubsub::Subscription#labels= (method)">#labels=</a></span> to update the labels for this subscription.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The frozen labels hash.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


187
188
189</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 187</span>

<span class='kw'>def</span> <span class='id identifier rubyid_labels'>labels</span>
  <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_labels'>labels</span><span class='period'>.</span><span class='id identifier rubyid_to_h'>to_h</span><span class='period'>.</span><span class='id identifier rubyid_freeze'>freeze</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="labels=-instance_method">
  
    #<strong>labels=</strong>(new_labels)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Sets the hash of user-provided labels associated with this
subscription. Labels can be used to organize and group subscriptions.
Label keys and values can be no longer than 63 characters, can only
contain lowercase letters, numeric characters, underscores and dashes.
International characters are allowed. Label values are optional. Label
keys must start with a letter and each label in the list must have a
different key. See <a href="https://cloud.google.com/pubsub/docs/labels">Creating and Managing
Labels</a>.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>new_labels</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The new labels hash.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Raises:</p>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>ArgumentError</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


203
204
205
206
207
208
209
210
211</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 203</span>

<span class='kw'>def</span> <span class='id identifier rubyid_labels='>labels=</span> <span class='id identifier rubyid_new_labels'>new_labels</span>
  <span class='id identifier rubyid_raise'>raise</span> <span class='const'>ArgumentError</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Value must be a Hash</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='id identifier rubyid_new_labels'>new_labels</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span>
  <span class='id identifier rubyid_labels_map'>labels_map</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Protobuf.html" title="Google::Protobuf (module)">Protobuf</a></span></span><span class='op'>::</span><span class='const'>Map</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span><span class='symbol'>:string</span><span class='comma'>,</span> <span class='symbol'>:string</span><span class='rparen'>)</span>
  <span class='const'>Hash</span><span class='lparen'>(</span><span class='id identifier rubyid_new_labels'>new_labels</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span> <span class='id identifier rubyid_labels_map'>labels_map</span><span class='lbracket'>[</span><span class='const'>String</span><span class='lparen'>(</span><span class='id identifier rubyid_k'>k</span><span class='rparen'>)</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>String</span><span class='lparen'>(</span><span class='id identifier rubyid_v'>v</span><span class='rparen'>)</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_update_grpc'>update_grpc</span> <span class='op'>=</span> <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_update_grpc'>update_grpc</span><span class='period'>.</span><span class='id identifier rubyid_labels'>labels</span> <span class='op'>=</span> <span class='id identifier rubyid_labels_map'>labels_map</span>
  <span class='ivar'>@grpc</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_update_subscription'>update_subscription</span> <span class='id identifier rubyid_update_grpc'>update_grpc</span><span class='comma'>,</span> <span class='symbol'>:labels</span>
  <span class='ivar'>@lazy</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="listen-instance_method">
  
    #<strong>listen</strong>(deadline: nil, streams: nil, inventory: nil, threads: {}) {|received_message| ... } &#x21d2; <tt><span class='object_link'><a href="Subscriber.html" title="Google::Cloud::Pubsub::Subscriber (class)">Subscriber</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Create a <span class='object_link'><a href="Subscriber.html" title="Google::Cloud::Pubsub::Subscriber (class)">Google::Cloud::Pubsub::Subscriber</a></span> object that receives  and processes messages
using the code provided in the callback.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_subscriber'>subscriber</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_listen'>listen</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_received_message'>received_message</span><span class='op'>|</span>
  <span class='comment'># process message
</span>  <span class='id identifier rubyid_received_message'>received_message</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge!'>acknowledge!</span>
<span class='kw'>end</span>

<span class='comment'># Start background threads that will call block passed to listen.
</span><span class='id identifier rubyid_subscriber'>subscriber</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span>

<span class='comment'># Shut down the subscriber when ready to stop receiving messages.
</span><span class='id identifier rubyid_subscriber'>subscriber</span><span class='period'>.</span><span class='id identifier rubyid_stop'>stop</span><span class='period'>.</span><span class='id identifier rubyid_wait!'>wait!</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Configuring to increase concurrent callbacks:</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_subscriber'>subscriber</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_listen'>listen</span> <span class='label'>threads:</span> <span class='lbrace'>{</span> <span class='label'>callback:</span> <span class='int'>16</span> <span class='rbrace'>}</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_rec_message'>rec_message</span><span class='op'>|</span>
  <span class='comment'># store the message somewhere before acknowledging
</span>  <span class='id identifier rubyid_store_in_backend'>store_in_backend</span> <span class='id identifier rubyid_rec_message'>rec_message</span><span class='period'>.</span><span class='id identifier rubyid_data'>data</span> <span class='comment'># takes a few seconds
</span>  <span class='id identifier rubyid_rec_message'>rec_message</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge!'>acknowledge!</span>
<span class='kw'>end</span>

<span class='comment'># Start background threads that will call block passed to listen.
</span><span class='id identifier rubyid_subscriber'>subscriber</span><span class='period'>.</span><span class='id identifier rubyid_start'>start</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>deadline</span>
      
      
        <span class='type'>(<tt>Numeric</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The default number of seconds the stream
will hold received messages before modifying the message&#39;s ack
deadline. The minimum is 10, the maximum is 600. Default is
<span class='object_link'><a href="#deadline-instance_method" title="Google::Cloud::Pubsub::Subscription#deadline (method)">#deadline</a></span>. Optional.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>streams</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The number of concurrent streams to open to
pull messages from the subscription. Default is 4. Optional.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>inventory</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The number of received messages to be
collected by subscriber. Default is 1,000. Optional.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>threads</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The number of threads to create to handle
concurrent calls by each stream opened by the subscriber. Optional.</p>

<p>Hash keys and values may include the following:</p>

<ul>
<li><code>:callback</code> (Integer) The number of threads used to handle the
received messages. Default is 8.</li>
<li><code>:push</code> (Integer) The number of threads to handle
acknowledgement (<span class='object_link'><a href="ReceivedMessage.html#ack!-instance_method" title="Google::Cloud::Pubsub::ReceivedMessage#ack! (method)">ReceivedMessage#ack!</a></span>) and delay messages
(<span class='object_link'><a href="ReceivedMessage.html#nack!-instance_method" title="Google::Cloud::Pubsub::ReceivedMessage#nack! (method)">ReceivedMessage#nack!</a></span>, <span class='object_link'><a href="ReceivedMessage.html#delay!-instance_method" title="Google::Cloud::Pubsub::ReceivedMessage#delay! (method)">ReceivedMessage#delay!</a></span>). Default is
4.</li>
</ul>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt>received_message</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a block for processing new messages</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>received_message</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="ReceivedMessage.html" title="Google::Cloud::Pubsub::ReceivedMessage (class)">ReceivedMessage</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the newly received
message</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Subscriber.html" title="Google::Cloud::Pubsub::Subscriber (class)">Subscriber</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


429
430
431
432
433
434
435
436
437</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 429</span>

<span class='kw'>def</span> <span class='id identifier rubyid_listen'>listen</span> <span class='label'>deadline:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>streams:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>inventory:</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='label'>threads:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
           <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_deadline'>deadline</span> <span class='op'>||=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_deadline'>deadline</span>

  <span class='const'><span class='object_link'><a href="Subscriber.html" title="Google::Cloud::Pubsub::Subscriber (class)">Subscriber</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_block'>block</span><span class='comma'>,</span> <span class='label'>deadline:</span> <span class='id identifier rubyid_deadline'>deadline</span><span class='comma'>,</span> <span class='label'>streams:</span> <span class='id identifier rubyid_streams'>streams</span><span class='comma'>,</span>
                              <span class='label'>inventory:</span> <span class='id identifier rubyid_inventory'>inventory</span><span class='comma'>,</span> <span class='label'>threads:</span> <span class='id identifier rubyid_threads'>threads</span><span class='comma'>,</span>
                              <span class='label'>service:</span> <span class='id identifier rubyid_service'>service</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="name-instance_method">
  
    #<strong>name</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The name of the subscription.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


69
70
71</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 69</span>

<span class='kw'>def</span> <span class='id identifier rubyid_name'>name</span>
  <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="policy-instance_method">
  
    #<strong>policy</strong> {|policy| ... } &#x21d2; <tt><span class='object_link'><a href="Policy.html" title="Google::Cloud::Pubsub::Policy (class)">Policy</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Gets the <a href="https://cloud.google.com/iam/">Cloud IAM</a> access control
policy for this subscription.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>
<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-subscription</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_policy'>policy</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_policy'>policy</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Update the policy by passing a block:</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>
<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-subscription</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_policy'>policy</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_p'>p</span><span class='op'>|</span>
  <span class='id identifier rubyid_p'>p</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>roles/owner</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user:owner@example.com</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></code></pre>
    
  </div>

<p class="tag_title">Yields:</p>
<ul class="yield">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="#policy-instance_method" title="Google::Cloud::Pubsub::Subscription#policy (method)">policy</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>A block for updating the policy. The latest policy
will be read from the Pub/Sub service and passed to the block. After
the block completes, the modified policy will be written to the
service.</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Yield Parameters:</p>
<ul class="yieldparam">
  
    <li>
      
        <span class='name'>policy</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Policy.html" title="Google::Cloud::Pubsub::Policy (class)">Policy</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the current Cloud IAM Policy for this
subscription</p>
</div>
      
    </li>
  
</ul>
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Policy.html" title="Google::Cloud::Pubsub::Policy (class)">Policy</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the current Cloud IAM Policy for this subscription</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://cloud.google.com/pubsub/docs/reference/rpc/google.iam.v1#iampolicy" target="_parent" title="google.iam.v1.IAMPolicy">google.iam.v1.IAMPolicy</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


645
646
647
648
649
650
651
652</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 645</span>

<span class='kw'>def</span> <span class='id identifier rubyid_policy'>policy</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_grpc'>grpc</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_get_subscription_policy'>get_subscription_policy</span> <span class='id identifier rubyid_name'>name</span>
  <span class='id identifier rubyid_policy'>policy</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="Policy.html" title="Google::Cloud::Pubsub::Policy (class)">Policy</a></span></span><span class='period'>.</span><span class='id identifier rubyid_from_grpc'>from_grpc</span> <span class='id identifier rubyid_grpc'>grpc</span>
  <span class='kw'>return</span> <span class='id identifier rubyid_policy'>policy</span> <span class='kw'>unless</span> <span class='id identifier rubyid_block_given?'>block_given?</span>
  <span class='kw'>yield</span> <span class='id identifier rubyid_policy'>policy</span>
  <span class='id identifier rubyid_update_policy'>update_policy</span> <span class='id identifier rubyid_policy'>policy</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="pull-instance_method">
  
    #<strong>pull</strong>(immediate: true, max: 100)  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="ReceivedMessage.html" title="Google::Cloud::Pubsub::ReceivedMessage (class)">Google::Cloud::Pubsub::ReceivedMessage</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Pulls messages from the server. Returns an empty list if there are no
messages available in the backlog. Raises an ApiError with status
<code>UNAVAILABLE</code> if there are too many concurrent pull requests pending
for the given subscription.</p>

<p>See also <span class='object_link'><a href="#listen-instance_method" title="Google::Cloud::Pubsub::Subscription#listen (method)">#listen</a></span> for the preferred way to process messages as they
become available.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_received_message'>received_message</span><span class='op'>|</span> <span class='id identifier rubyid_received_message'>received_message</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge!'>acknowledge!</span> <span class='rbrace'>}</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>A maximum number of messages returned can also be specified:</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span><span class='lparen'>(</span><span class='label'>max:</span> <span class='int'>10</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_received_message'>received_message</span><span class='op'>|</span>
  <span class='id identifier rubyid_received_message'>received_message</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge!'>acknowledge!</span>
<span class='kw'>end</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>The call can block until messages are available:</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_received_messages'>received_messages</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span> <span class='label'>immediate:</span> <span class='kw'>false</span>
<span class='id identifier rubyid_received_messages'>received_messages</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_received_message'>received_message</span><span class='op'>|</span>
  <span class='id identifier rubyid_received_message'>received_message</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge!'>acknowledge!</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>immediate</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>When <code>true</code> the system will respond
immediately even if it is not able to return messages. When <code>false</code>
the system is allowed to wait until it can return least one message.
No messages are returned when a request times out. The default value
is <code>true</code>.</p>

<p>See also <span class='object_link'><a href="#listen-instance_method" title="Google::Cloud::Pubsub::Subscription#listen (method)">#listen</a></span> for the preferred way to process messages as they
become available.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>max</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The maximum number of messages to return for this
request. The Pub/Sub system may return fewer than the number
specified. The default value is <code>100</code>, the maximum value is <code>1000</code>.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="ReceivedMessage.html" title="Google::Cloud::Pubsub::ReceivedMessage (class)">Google::Cloud::Pubsub::ReceivedMessage</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


324
325
326
327
328
329
330
331
332
333</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 324</span>

<span class='kw'>def</span> <span class='id identifier rubyid_pull'>pull</span> <span class='label'>immediate:</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='label'>max:</span> <span class='int'>100</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='label'>immediate:</span> <span class='id identifier rubyid_immediate'>immediate</span><span class='comma'>,</span> <span class='label'>max:</span> <span class='id identifier rubyid_max'>max</span> <span class='rbrace'>}</span>
  <span class='id identifier rubyid_list_grpc'>list_grpc</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_options'>options</span>
  <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_list_grpc'>list_grpc</span><span class='period'>.</span><span class='id identifier rubyid_received_messages'>received_messages</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_msg_grpc'>msg_grpc</span><span class='op'>|</span>
    <span class='const'><span class='object_link'><a href="ReceivedMessage.html" title="Google::Cloud::Pubsub::ReceivedMessage (class)">ReceivedMessage</a></span></span><span class='period'>.</span><span class='id identifier rubyid_from_grpc'>from_grpc</span> <span class='id identifier rubyid_msg_grpc'>msg_grpc</span><span class='comma'>,</span> <span class='kw'>self</span>
  <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'>DeadlineExceededError</span>
  <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="retain_acked-instance_method">
  
    #<strong>retain_acked</strong>  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Indicates whether to retain acknowledged messages. If <code>true</code>, then
messages are not expunged from the subscription&#39;s backlog, even if
they are acknowledged, until they fall out of the <span class='object_link'><a href="#retention-instance_method" title="Google::Cloud::Pubsub::Subscription#retention (method)">#retention</a></span> window.
Default is <code>false</code>.</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Returns <code>true</code> if acknowledged messages are
retained.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


117
118
119
120</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 117</span>

<span class='kw'>def</span> <span class='id identifier rubyid_retain_acked'>retain_acked</span>
  <span class='id identifier rubyid_ensure_grpc!'>ensure_grpc!</span>
  <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_retain_acked_messages'>retain_acked_messages</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="retain_acked=-instance_method">
  
    #<strong>retain_acked=</strong>(new_retain_acked)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124
125
126
127
128</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 122</span>

<span class='kw'>def</span> <span class='id identifier rubyid_retain_acked='>retain_acked=</span> <span class='id identifier rubyid_new_retain_acked'>new_retain_acked</span>
  <span class='id identifier rubyid_update_grpc'>update_grpc</span> <span class='op'>=</span> <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_update_grpc'>update_grpc</span><span class='period'>.</span><span class='id identifier rubyid_retain_acked_messages'>retain_acked_messages</span> <span class='op'>=</span> <span class='op'>!</span><span class='lparen'>(</span><span class='op'>!</span><span class='id identifier rubyid_new_retain_acked'>new_retain_acked</span><span class='rparen'>)</span>
  <span class='ivar'>@grpc</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_update_subscription'>update_subscription</span> <span class='id identifier rubyid_update_grpc'>update_grpc</span><span class='comma'>,</span>
                                      <span class='symbol'>:retain_acked_messages</span>
  <span class='ivar'>@lazy</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="retention-instance_method">
  
    #<strong>retention</strong>  &#x21d2; <tt>Numeric</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>How long to retain unacknowledged messages in the subscription&#39;s
backlog, from the moment a message is published. If
<span class='object_link'><a href="#retain_acked-instance_method" title="Google::Cloud::Pubsub::Subscription#retain_acked (method)">#retain_acked</a></span> is <code>true</code>, then this also configures the retention of
acknowledged messages, and thus configures how far back in time a
<span class='object_link'><a href="#seek-instance_method" title="Google::Cloud::Pubsub::Subscription#seek (method)">#seek</a></span> can be done. Cannot be more than 604,800 seconds (7 days) or
less than 600 seconds (10 minutes). Default is 604,800 seconds (7
days).</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Numeric</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The message retention duration in seconds.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


141
142
143
144</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 141</span>

<span class='kw'>def</span> <span class='id identifier rubyid_retention'>retention</span>
  <span class='id identifier rubyid_ensure_grpc!'>ensure_grpc!</span>
  <span class='const'>Convert</span><span class='period'>.</span><span class='id identifier rubyid_duration_to_number'>duration_to_number</span> <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_message_retention_duration'>message_retention_duration</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="retention=-instance_method">
  
    #<strong>retention=</strong>(new_retention)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


146
147
148
149
150
151
152
153</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 146</span>

<span class='kw'>def</span> <span class='id identifier rubyid_retention='>retention=</span> <span class='id identifier rubyid_new_retention'>new_retention</span>
  <span class='id identifier rubyid_update_grpc'>update_grpc</span> <span class='op'>=</span> <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_update_grpc'>update_grpc</span><span class='period'>.</span><span class='id identifier rubyid_message_retention_duration'>message_retention_duration</span> <span class='op'>=</span> \
    <span class='const'>Convert</span><span class='period'>.</span><span class='id identifier rubyid_number_to_duration'>number_to_duration</span> <span class='id identifier rubyid_new_retention'>new_retention</span>
  <span class='ivar'>@grpc</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_update_subscription'>update_subscription</span> <span class='id identifier rubyid_update_grpc'>update_grpc</span><span class='comma'>,</span>
                                      <span class='symbol'>:message_retention_duration</span>
  <span class='ivar'>@lazy</span> <span class='op'>=</span> <span class='kw'>nil</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="seek-instance_method">
  
    #<strong>seek</strong>(snapshot)  &#x21d2; <tt>Boolean</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Resets the subscription&#39;s backlog to a given <span class='object_link'><a href="Snapshot.html" title="Google::Cloud::Pubsub::Snapshot (class)">Google::Cloud::Pubsub::Snapshot</a></span> or to a point
in time, whichever is provided in the request.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
        <p class="example_title"><div class='inline'><p>Using a snapshot</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>
<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-sub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_snapshot'>snapshot</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_create_snapshot'>create_snapshot</span>

<span class='id identifier rubyid_received_messages'>received_messages</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span>
<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge'>acknowledge</span> <span class='id identifier rubyid_received_messages'>received_messages</span>

<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_seek'>seek</span> <span class='id identifier rubyid_snapshot'>snapshot</span></code></pre>
    
      
        <p class="example_title"><div class='inline'><p>Using a time:</p>
</div></p>
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>
<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-sub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_time'>time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id identifier rubyid_now'>now</span>

<span class='id identifier rubyid_received_messages'>received_messages</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_pull'>pull</span>
<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge'>acknowledge</span> <span class='id identifier rubyid_received_messages'>received_messages</span>

<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_seek'>seek</span> <span class='id identifier rubyid_time'>time</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>snapshot</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Snapshot.html" title="Google::Cloud::Pubsub::Snapshot (class)">Snapshot</a></span></tt>, <tt>String</tt>, <tt>Time</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The <code>Snapshot</code> instance,
snapshot name, or time to which to perform the seek.
If the argument is a snapshot, the snapshot&#39;s topic must be the
same as that of the subscription. If it is a time, messages retained
in the subscription that were published before this time are marked
as acknowledged, and messages retained in the subscription that were
published after this time are marked as unacknowledged. Note that
this operation affects only those messages retained in the
subscription. For example, if the time corresponds to a point before
the message retention window (or to a point before the system&#39;s
notion of the subscription creation time), only retained messages
will be marked as unacknowledged, and already-expunged messages will
not be restored.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>Returns <code>true</code> if the seek was successful.</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


605
606
607
608
609</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 605</span>

<span class='kw'>def</span> <span class='id identifier rubyid_seek'>seek</span> <span class='id identifier rubyid_snapshot'>snapshot</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_seek'>seek</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_snapshot'>snapshot</span>
  <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="test_permissions-instance_method">
  
    #<strong>test_permissions</strong>(*permissions)  &#x21d2; <tt>Array&lt;String&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Tests the specified permissions against the <a href="https://cloud.google.com/iam/">Cloud
IAM</a> access control policy.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>
<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-subscription</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_perms'>perms</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_test_permissions'>test_permissions</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pubsub.subscriptions.get</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span>
                             <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pubsub.subscriptions.consume</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_perms'>perms</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pubsub.subscriptions.get</span><span class='tstring_end'>&quot;</span></span> <span class='comment'>#=&gt; true
</span><span class='id identifier rubyid_perms'>perms</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>pubsub.subscriptions.consume</span><span class='tstring_end'>&quot;</span></span> <span class='comment'>#=&gt; false</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>permissions</span>
      
      
        <span class='type'>(<tt>String</tt>, <tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The set of permissions to
check access for. Permissions with wildcards (such as <code>*</code> or
<code>storage.*</code>) are not allowed.</p>

<p>The permissions that can be checked on a subscription are:</p>

<ul>
<li>pubsub.subscriptions.consume</li>
<li>pubsub.subscriptions.get</li>
<li>pubsub.subscriptions.delete</li>
<li>pubsub.subscriptions.update</li>
<li>pubsub.subscriptions.getIamPolicy</li>
<li>pubsub.subscriptions.setIamPolicy</li>
</ul>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;String&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The permissions that have access.</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://cloud.google.com/iam/docs/managing-policies" target="_parent" title="Managing Policies">Managing Policies</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


722
723
724
725
726
727</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 722</span>

<span class='kw'>def</span> <span class='id identifier rubyid_test_permissions'>test_permissions</span> <span class='op'>*</span><span class='id identifier rubyid_permissions'>permissions</span>
  <span class='id identifier rubyid_permissions'>permissions</span> <span class='op'>=</span> <span class='const'>Array</span><span class='lparen'>(</span><span class='id identifier rubyid_permissions'>permissions</span><span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_grpc'>grpc</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_test_subscription_permissions'>test_subscription_permissions</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_permissions'>permissions</span>
  <span class='id identifier rubyid_grpc'>grpc</span><span class='period'>.</span><span class='id identifier rubyid_permissions'>permissions</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="topic-instance_method">
  
    #<strong>topic</strong>  &#x21d2; <tt><span class='object_link'><a href="Topic.html" title="Google::Cloud::Pubsub::Topic (class)">Topic</a></span></tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The <span class='object_link'><a href="Topic.html" title="Google::Cloud::Pubsub::Topic (class)">Topic</a></span> from which this subscription receives messages.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_topic'>topic</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span> <span class='comment'>#=&gt; &quot;projects/my-project/topics/my-topic&quot;</span></code></pre>
    
  </div>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Topic.html" title="Google::Cloud::Pubsub::Topic (class)">Topic</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88
89</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 86</span>

<span class='kw'>def</span> <span class='id identifier rubyid_topic'>topic</span>
  <span class='id identifier rubyid_ensure_grpc!'>ensure_grpc!</span>
  <span class='const'><span class='object_link'><a href="Topic.html" title="Google::Cloud::Pubsub::Topic (class)">Topic</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new_lazy'>new_lazy</span> <span class='ivar'>@grpc</span><span class='period'>.</span><span class='id identifier rubyid_topic'>topic</span><span class='comma'>,</span> <span class='id identifier rubyid_service'>service</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_policy-instance_method">
  
    #<strong>update_policy</strong>(new_policy)  &#x21d2; <tt><span class='object_link'><a href="Policy.html" title="Google::Cloud::Pubsub::Policy (class)">Policy</a></span></tt> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='policy=-instance_method'>policy=</span></span>
    </span>
  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Updates the <a href="https://cloud.google.com/iam/">Cloud IAM</a> access control
policy for this subscription. The policy should be read from
<span class='object_link'><a href="#policy-instance_method" title="Google::Cloud::Pubsub::Subscription#policy (method)">#policy</a></span>. See <span class='object_link'><a href="Policy.html" title="Google::Cloud::Pubsub::Policy (class)">Policy</a></span> for an explanation of
the policy <code>etag</code> property and how to modify policies.</p>

<p>You can also update the policy by passing a block to <span class='object_link'><a href="#policy-instance_method" title="Google::Cloud::Pubsub::Subscription#policy (method)">#policy</a></span>, which
will call this method internally after the block completes.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>
<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-subscription</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_policy'>policy</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_policy'>policy</span> <span class='comment'># API call
</span>
<span class='id identifier rubyid_policy'>policy</span><span class='period'>.</span><span class='id identifier rubyid_add'>add</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>roles/owner</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>user:owner@example.com</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_update_policy'>update_policy</span> <span class='id identifier rubyid_policy'>policy</span> <span class='comment'># API call</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>new_policy</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Policy.html" title="Google::Cloud::Pubsub::Policy (class)">Policy</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>a new or modified Cloud IAM Policy for this
subscription</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Policy.html" title="Google::Cloud::Pubsub::Policy (class)">Policy</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>the policy returned by the API update operation</p>
</div>
      
    </li>
  
</ul>

  <p class="tag_title">See Also:</p>
  <ul class="see">
    
      <li><a href="https://cloud.google.com/pubsub/docs/reference/rpc/google.iam.v1#iampolicy" target="_parent" title="google.iam.v1.IAMPolicy">google.iam.v1.IAMPolicy</a></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


683
684
685
686
687</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 683</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_policy'>update_policy</span> <span class='id identifier rubyid_new_policy'>new_policy</span>
  <span class='id identifier rubyid_ensure_service!'>ensure_service!</span>
  <span class='id identifier rubyid_grpc'>grpc</span> <span class='op'>=</span> <span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_set_subscription_policy'>set_subscription_policy</span> <span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_new_policy'>new_policy</span><span class='period'>.</span><span class='id identifier rubyid_to_grpc'>to_grpc</span>
  <span class='const'><span class='object_link'><a href="Policy.html" title="Google::Cloud::Pubsub::Policy (class)">Policy</a></span></span><span class='period'>.</span><span class='id identifier rubyid_from_grpc'>from_grpc</span> <span class='id identifier rubyid_grpc'>grpc</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="wait_for_messages-instance_method">
  
    #<strong>wait_for_messages</strong>(max: 100)  &#x21d2; <tt>Array&lt;<span class='object_link'><a href="ReceivedMessage.html" title="Google::Cloud::Pubsub::ReceivedMessage (class)">Google::Cloud::Pubsub::ReceivedMessage</a></span>&gt;</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Pulls from the server while waiting for messages to become available.
This is the same as:</p>

<p>subscription.pull immediate: false</p>

<p>See also <span class='object_link'><a href="#listen-instance_method" title="Google::Cloud::Pubsub::Subscription#listen (method)">#listen</a></span> for the preferred way to process messages as they
become available.</p>


  </div>
</div>
<div class="tags">
  
  <div class="examples">
    <p class="tag_title">Examples:</p>
    
      
      <pre class="example code"><code><span class='id identifier rubyid_require'>require</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>google/cloud/pubsub</span><span class='tstring_end'>&quot;</span></span>

<span class='id identifier rubyid_pubsub'>pubsub</span> <span class='op'>=</span> <span class='const'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span><span class='op'>::</span><span class='const'><span class='object_link'><a href="../Pubsub.html" title="Google::Cloud::Pubsub (module)">Pubsub</a></span></span><span class='period'>.</span><span class='id identifier rubyid_new'><span class='object_link'><a href="../Pubsub.html#new-class_method" title="Google::Cloud::Pubsub.new (method)">new</a></span></span>

<span class='id identifier rubyid_sub'>sub</span> <span class='op'>=</span> <span class='id identifier rubyid_pubsub'>pubsub</span><span class='period'>.</span><span class='id identifier rubyid_subscription'>subscription</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>my-topic-sub</span><span class='tstring_end'>&quot;</span></span>
<span class='id identifier rubyid_received_messages'>received_messages</span> <span class='op'>=</span> <span class='id identifier rubyid_sub'>sub</span><span class='period'>.</span><span class='id identifier rubyid_wait_for_messages'>wait_for_messages</span>
<span class='id identifier rubyid_received_messages'>received_messages</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_received_message'>received_message</span><span class='op'>|</span>
  <span class='id identifier rubyid_received_message'>received_message</span><span class='period'>.</span><span class='id identifier rubyid_acknowledge!'>acknowledge!</span>
<span class='kw'>end</span></code></pre>
    
  </div>
<p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>max</span>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The maximum number of messages to return for this
request. The Pub/Sub system may return fewer than the number
specified. The default value is <code>100</code>, the maximum value is <code>1000</code>.</p>
</div>
      
    </li>
  
</ul>

<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Array&lt;<span class='object_link'><a href="ReceivedMessage.html" title="Google::Cloud::Pubsub::ReceivedMessage (class)">Google::Cloud::Pubsub::ReceivedMessage</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


361
362
363</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/pubsub/subscription.rb', line 361</span>

<span class='kw'>def</span> <span class='id identifier rubyid_wait_for_messages'>wait_for_messages</span> <span class='label'>max:</span> <span class='int'>100</span>
  <span class='id identifier rubyid_pull'>pull</span> <span class='label'>immediate:</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='label'>max:</span> <span class='id identifier rubyid_max'>max</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

  <div id="footer">
  <ul class="footer-links">
    <li>
      <a href="https://github.com/GoogleCloudPlatform/google-cloud-ruby" title="Google Cloud on Github">
        <img src="/google-cloud-ruby/img/icon-link-github.svg" alt="GitHub icon"> GitHub
      </a>
    </li>
    <li>
      <a href="https://github.com/GoogleCloudPlatform/google-cloud-ruby/issues" title="Google Cloud issues on Github">
        <img src="/google-cloud-ruby/img/icon-link-github.svg" alt="GitHub icon"> Issues
      </a>
    </li>
    <li>
      <a href="http://stackoverflow.com/questions/tagged/google-cloud-ruby" title="Google Cloud on StackOverflow">
      <img src="/google-cloud-ruby/img/icon-link-stackoverflow.svg" alt="StackOverflow icon"> StackOverflow
    </a>
    </li>
    <li>
      <a href="http://rubygems.org/gems/google-cloud" title="Google Cloud on RubyGems">
        <img src="/google-cloud-ruby/img/icon-link-package-manager.svg" alt="RubyGems icon"> RubyGems
      </a>
    </li>
  </ul>

  <p>
    Documentation generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>.
  </p>
</div>

</div>
