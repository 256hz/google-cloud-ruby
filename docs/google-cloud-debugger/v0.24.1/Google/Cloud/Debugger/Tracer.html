---
layout: yard_main
title: "Class: Google::Cloud::Debugger::Tracer - Stackdriver"
css: 
  - /docs/css/style.css
  - /docs/css/common.css
  - /css/yard-main.css
js: 
  - /docs/js/app.js
  - /js/yard-main.js
---
<script type="text/javascript" charset="utf-8">
  pathId = "Google::Cloud::Debugger::Tracer";
  relpath = '../../../';
</script>


<div class="nav_wrap">
  <iframe id="nav" src="../../../class_list.html?1"></iframe>
  <div id="resizer"></div>
</div>

<div id="main" tabindex="-1">
  <div id="header">
    <div id="menu">
  
    <a href="../../../_index.html">Index (T)</a> &raquo;
    <span class='title'><span class='object_link'><a href="../../../Google.html" title="Google (module)">Google</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Cloud.html" title="Google::Cloud (module)">Cloud</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Debugger.html" title="Google::Cloud::Debugger (module)">Debugger</a></span></span>
     &raquo; 
    <span class="title">Tracer</span>
  
</div>

    <div id="search">
  
    <a class="full_list_link" id="class_list_link"
        href="../../../class_list.html">

        <svg width="24" height="24">
          <rect x="0" y="4" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="12" width="24" height="4" rx="1" ry="1"></rect>
          <rect x="0" y="20" width="24" height="4" rx="1" ry="1"></rect>
        </svg>
    </a>
  
</div>
    <div class="clear"></div>
  </div>

  <div id="content"><h1>Class: Google::Cloud::Debugger::Tracer
  
  
  
</h1>
<div class="box_info">
  
  <dl>
    <dt>Inherits:</dt>
    <dd>
      <span class="inheritName">Object</span>
      
        <ul class="fullTree">
          <li>Object</li>
          
            <li class="next">Google::Cloud::Debugger::Tracer</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
    </dd>
  </dl>
  

  
  
  
  
  

  

  
  <dl>
    <dt>Defined in:</dt>
    <dd>lib/google/cloud/debugger/tracer.rb</dd>
  </dl>
  
</div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <h1>Tracer</h1>

<p>When active breakpoints are set for the debugger, the tracer monitors
the running Ruby application and triggers evaluation when the code is
executed at the breakpoint locations.</p>

<p>The tracer tracks the running application using several Ruby TracePoints
and C level Ruby debugging API.</p>


  </div>
</div>
<div class="tags">
  

</div>



  <h2>Instance Attribute Summary <small><a href="#" class="summary_toggle">collapse</a></small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#agent-instance_method" title="#agent (instance method)">#<strong>agent</strong>  &#x21d2; Google::Cloud::Debugger::Agent </a>
    

    
  </span>
  
  
  
    
      <span class="note title readonly">readonly</span>
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>The debugger agent this tracer belongs to.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#app_root-instance_method" title="#app_root (instance method)">#<strong>app_root</strong>  &#x21d2; String </a>
    

    
  </span>
  
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Ruby application root directory, in absolute path form.</p>
</div></span>
  
</li>

    
  </ul>




  
    <h2>
      Instance Method Summary
      <small><a href="#" class="summary_toggle">collapse</a></small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#eval_breakpoint-instance_method" title="#eval_breakpoint (instance method)">#<strong>eval_breakpoint</strong>(breakpoint, call_stack_bindings)  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Evaluates a hit breakpoint, and signal BreakpointManager and Transmitter if this breakpoint is evaluated successfully.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#start-instance_method" title="#start (instance method)">#<strong>start</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Get the sync the breakpoints cache with BreakpointManager.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stop-instance_method" title="#stop (instance method)">#<strong>stop</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Stops all tracing.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_breakpoints_cache-instance_method" title="#update_breakpoints_cache (instance method)">#<strong>update_breakpoints_cache</strong>  &#x21d2; Object </a>
    

    
  </span>
  
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>Update tracer&#39;s private breakpoints cache with the list of active breakpoints from BreakpointManager.</p>
</div></span>
  
</li>

      
    </ul>
  


  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <div class="method_details first">
  <h3 class="signature first" id="agent-instance_method">
  
    #<strong>agent</strong>  &#x21d2; <tt><span class='object_link'><a href="Agent.html" title="Google::Cloud::Debugger::Agent (class)">Google::Cloud::Debugger::Agent</a></span></tt>  <span class="extras">(readonly)</span>
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>The debugger agent this tracer belongs to</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Agent.html" title="Google::Cloud::Debugger::Agent (class)">Google::Cloud::Debugger::Agent</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


35
36
37</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/debugger/tracer.rb', line 35</span>

<span class='kw'>def</span> <span class='id identifier rubyid_agent'>agent</span>
  <span class='ivar'>@agent</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id="app_root=-instance_method"></span>
      <div class="method_details ">
  <h3 class="signature " id="app_root-instance_method">
  
    #<strong>app_root</strong>  &#x21d2; <tt>String</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Ruby application root directory, in absolute path form. The
Stackdriver Debugger Service only knows the relative application file
path. So the tracer needs to combine relative file path with
application root directory to get full file path for tracing purpose</p>


  </div>
</div>
<div class="tags">
  
<p class="tag_title">Returns:</p>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>String</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/debugger/tracer.rb', line 43</span>

<span class='kw'>def</span> <span class='id identifier rubyid_app_root'>app_root</span>
  <span class='ivar'>@app_root</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>

    
      <div class="method_details first">
  <h3 class="signature first" id="eval_breakpoint-instance_method">
  
    #<strong>eval_breakpoint</strong>(breakpoint, call_stack_bindings)  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Evaluates a hit breakpoint, and signal BreakpointManager and
Transmitter if this breakpoint is evaluated successfully.</p>

<p>See <span class='object_link'><a href="Breakpoint.html#eval_call_stack-instance_method" title="Google::Cloud::Debugger::Breakpoint#eval_call_stack (method)">Breakpoint#eval_call_stack</a></span> for evaluation details.</p>


  </div>
</div>
<div class="tags">
  <p class="tag_title">Parameters:</p>
<ul class="param">
  
    <li>
      
        <span class='name'>breakpoint</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Breakpoint.html" title="Google::Cloud::Debugger::Breakpoint (class)">Google::Cloud::Debugger::Breakpoint</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>The breakpoint
to be evaluated</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>call_stack_bindings</span>
      
      
        <span class='type'>(<tt>Array&lt;Binding&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>An array of Ruby Binding
objects, from the each frame of the call stack that leads to the
triggering of the breakpoints.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


117
118
119
120
121
122
123
124
125
126
127
128
129
130
131
132
133
134
135
136</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/debugger/tracer.rb', line 117</span>

<span class='kw'>def</span> <span class='id identifier rubyid_eval_breakpoint'>eval_breakpoint</span> <span class='id identifier rubyid_breakpoint'>breakpoint</span><span class='comma'>,</span> <span class='id identifier rubyid_call_stack_bindings'>call_stack_bindings</span>
  <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_breakpoint'>breakpoint</span><span class='period'>.</span><span class='id identifier rubyid_nil?'>nil?</span> <span class='op'>||</span> <span class='id identifier rubyid_breakpoint'>breakpoint</span><span class='period'>.</span><span class='id identifier rubyid_complete?'>complete?</span>

  <span class='id identifier rubyid_breakpoint'>breakpoint</span><span class='period'>.</span><span class='id identifier rubyid_eval_call_stack'>eval_call_stack</span> <span class='id identifier rubyid_call_stack_bindings'>call_stack_bindings</span>

  <span class='comment'># Take this completed breakpoint off manager&#39;s active breakpoints
</span>  <span class='comment'># list, submit the breakpoint snapshot, and update Tracer&#39;s
</span>  <span class='comment'># breakpoints_cache.
</span>  <span class='kw'>return</span> <span class='kw'>unless</span> <span class='id identifier rubyid_breakpoint'>breakpoint</span><span class='period'>.</span><span class='id identifier rubyid_complete?'>complete?</span>

  <span class='comment'># Signal breakpoint_manager that this breakpoint is evaluated
</span>  <span class='id identifier rubyid_agent'>agent</span><span class='period'>.</span><span class='id identifier rubyid_breakpoint_manager'>breakpoint_manager</span><span class='period'>.</span><span class='id identifier rubyid_mark_off'>mark_off</span> <span class='id identifier rubyid_breakpoint'>breakpoint</span>
  <span class='comment'># Signal transmitter to submit this breakpoint
</span>  <span class='id identifier rubyid_agent'>agent</span><span class='period'>.</span><span class='id identifier rubyid_transmitter'>transmitter</span><span class='period'>.</span><span class='id identifier rubyid_submit'>submit</span> <span class='id identifier rubyid_breakpoint'>breakpoint</span>

  <span class='id identifier rubyid_update_breakpoints_cache'>update_breakpoints_cache</span>

  <span class='comment'># Disable all trace points and tracing if all breakpoints are complete
</span>  <span class='id identifier rubyid_disable_traces'>disable_traces</span> <span class='kw'>if</span> <span class='ivar'>@breakpoints_cache</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="start-instance_method">
  
    #<strong>start</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Get the sync the breakpoints cache with BreakpointManager. Start
tracing and monitoring if there are any breakpoints.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


152
153
154
155</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/debugger/tracer.rb', line 152</span>

<span class='kw'>def</span> <span class='id identifier rubyid_start'>start</span>
  <span class='id identifier rubyid_update_breakpoints_cache'>update_breakpoints_cache</span>
  <span class='id identifier rubyid_enable_traces'>enable_traces</span> <span class='kw'>unless</span> <span class='id identifier rubyid_breakpoints_cache'>breakpoints_cache</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="stop-instance_method">
  
    #<strong>stop</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Stops all tracing.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


159
160
161</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/debugger/tracer.rb', line 159</span>

<span class='kw'>def</span> <span class='id identifier rubyid_stop'>stop</span>
  <span class='id identifier rubyid_disable_traces'>disable_traces</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <h3 class="signature " id="update_breakpoints_cache-instance_method">
  
    #<strong>update_breakpoints_cache</strong>  &#x21d2; <tt>Object</tt> 
  

  

  
</h3><div class="docstring">
  <div class="discussion">
    <p>Update tracer&#39;s private breakpoints cache with the list of active
breakpoints from BreakpointManager.</p>

<p>This methood is atomic for thread safety purpose.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89
90
91
92
93
94
95
96
97
98
99
100
101
102
103</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/google/cloud/debugger/tracer.rb', line 87</span>

<span class='kw'>def</span> <span class='id identifier rubyid_update_breakpoints_cache'>update_breakpoints_cache</span>
  <span class='id identifier rubyid_active_breakpoints'>active_breakpoints</span> <span class='op'>=</span> <span class='id identifier rubyid_agent'>agent</span><span class='period'>.</span><span class='id identifier rubyid_breakpoint_manager'>breakpoint_manager</span><span class='period'>.</span><span class='id identifier rubyid_active_breakpoints'>active_breakpoints</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
  <span class='id identifier rubyid_breakpoints_hash'>breakpoints_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

  <span class='id identifier rubyid_active_breakpoints'>active_breakpoints</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id identifier rubyid_active_breakpoint'>active_breakpoint</span><span class='op'>|</span>
    <span class='id identifier rubyid_breakpoint_line'>breakpoint_line</span> <span class='op'>=</span> <span class='id identifier rubyid_active_breakpoint'>active_breakpoint</span><span class='period'>.</span><span class='id identifier rubyid_line'>line</span>
    <span class='id identifier rubyid_breakpoint_path'>breakpoint_path</span> <span class='op'>=</span> <span class='id identifier rubyid_full_breakpoint_path'>full_breakpoint_path</span> <span class='id identifier rubyid_active_breakpoint'>active_breakpoint</span><span class='period'>.</span><span class='id identifier rubyid_path'>path</span>
    <span class='id identifier rubyid_breakpoints_hash'>breakpoints_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_breakpoint_path'>breakpoint_path</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_breakpoints_hash'>breakpoints_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_breakpoint_path'>breakpoint_path</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_breakpoint_line'>breakpoint_line</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_breakpoints_hash'>breakpoints_hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_breakpoint_path'>breakpoint_path</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_breakpoint_line'>breakpoint_line</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_push'>push</span><span class='lparen'>(</span>
      <span class='id identifier rubyid_active_breakpoint'>active_breakpoint</span><span class='rparen'>)</span>
  <span class='kw'>end</span>

  <span class='comment'># Tracer is explicitly designed to not have a lock. This should be the
</span>  <span class='comment'># only place writing @breakpoints_cache to ensure thread safety.
</span>  <span class='ivar'>@breakpoints_cache</span> <span class='op'>=</span> <span class='id identifier rubyid_breakpoints_hash'>breakpoints_hash</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>

  <div id="footer">
  <ul class="footer-links">
    <li>
      <a href="https://github.com/GoogleCloudPlatform/google-cloud-ruby" title="Google Cloud on Github">
        <img src="/google-cloud-ruby/img/icon-link-github.svg" alt="GitHub icon"> GitHub
      </a>
    </li>
    <li>
      <a href="https://github.com/GoogleCloudPlatform/google-cloud-ruby/issues" title="Google Cloud issues on Github">
        <img src="/google-cloud-ruby/img/icon-link-github.svg" alt="GitHub icon"> Issues
      </a>
    </li>
    <li>
      <a href="http://stackoverflow.com/questions/tagged/google-cloud-ruby" title="Google Cloud on StackOverflow">
      <img src="/google-cloud-ruby/img/icon-link-stackoverflow.svg" alt="StackOverflow icon"> StackOverflow
    </a>
    </li>
    <li>
      <a href="http://rubygems.org/gems/google-cloud" title="Google Cloud on RubyGems">
        <img src="/google-cloud-ruby/img/icon-link-package-manager.svg" alt="RubyGems icon"> RubyGems
      </a>
    </li>
  </ul>

  <p>
    Documentation generated by <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool">yard</a>.
  </p>
</div>

</div>
